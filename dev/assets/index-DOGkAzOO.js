import{an as y,u as v,r as w,b as I,ac as F,j as e,c as z,ap as C,I as p,S as T,D as P}from"./index-BSVNpzLa.js";import{F as _}from"./Table-tw5fWF5b.js";import{u as k,a as m}from"./use-subscription-modal-CbIfBON8.js";import D from"./subscription-form-modal-CROQnKHa.js";import E from"./subscription-filter-S780MWiK.js";import{P as M}from"./index-wR-9yEIL.js";import{C as N}from"./index-DWIyLedh.js";import"./index-BZ9Ca08E.js";import"./index-aRqXbJJH.js";import"./programs-N_YEcOwc.js";const O={active:"processing",succeeded:"success",failed:"default",suspended:"warning",deleted:"error"};function G(){const[u]=y(),{t:i}=v(),[o,a]=w.useState(Object.fromEntries(u.entries())),{data:r,refetch:c,isLoading:l,isFetching:d}=I({queryKey:["subscriptions",o],queryFn:()=>m.get(o),refetchOnWindowFocus:!1}),{modalProps:f,onEdit:x}=k(()=>c()),h=F({mutationFn:s=>m.destroy(s),onSuccess(){c()}});function g(s){a(s)}function j(){a({})}const b=s=>{h.mutate(s.id)},S=[{title:i("app.fields.name"),dataIndex:"name",render:(s,t)=>{var n;return e.jsx("div",{children:(n=t.subscriber)==null?void 0:n.name})}},{title:i("app.fields.program"),dataIndex:"description",render:(s,t)=>{var n;return e.jsx("div",{children:(n=t.program)==null?void 0:n.name})}},{title:i("app.fields.level"),dataIndex:"description",render:(s,t)=>{var n;return e.jsx("div",{children:(n=t.level)==null?void 0:n.name})}},{title:i("app.fields.state"),dataIndex:"type",render:(s,t)=>e.jsx(z,{color:O[t.state],children:t.state})},{title:i("app.fields.note"),dataIndex:"description",render:(s,t)=>e.jsx("div",{children:t.notes})},{title:i("common.action"),dataIndex:"operation",width:100,render:(s,t)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(C,{onClick:()=>x(t),children:e.jsx(p,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(M,{title:i("common.confirm-deleting"),okText:i("common.ok"),cancelText:i("common.cancel"),placement:"left",onConfirm:()=>b(t),children:e.jsx("button",{type:"button",children:e.jsx(p,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(T,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(E,{formValue:o,okDisabled:l||d,onClear:j,onSearch:g}),e.jsx(P,{children:i("app.subscriptions.grid-header")}),e.jsxs(N,{title:i("app.subscriptions.grid-header"),children:[e.jsx(_,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:S,dataSource:r==null?void 0:r.items,loading:l||d,pagination:{pageSizeOptions:[10,30,50],current:o.page??1,showSizeChanger:!0,showQuickJumper:!0,total:r==null?void 0:r.total,onChange:(s,t)=>a({...o,page:s,pageSize:t})}}),e.jsx(D,{...f})]})]})}export{G as default};
