import{an as b,u as v,r as p,b as D,ac as F,j as e,ap as I,I as u,S as x,D as z,aq as E,B as P}from"./index-BSVNpzLa.js";import{F as M}from"./Table-tw5fWF5b.js";import{u as _,a as f}from"./use-task-modal-Csscxtb5.js";import N from"./task-form-modal-DiGtImeq.js";import O from"./task-filter-Cw8NU-av.js";import{d as Y}from"./dayjs.min-zlnj1wBl.js";import{P as q}from"./index-wR-9yEIL.js";import{C as B}from"./index-DWIyLedh.js";import"./index-BZ9Ca08E.js";import"./index-aRqXbJJH.js";import"./levels-DpsmfeEP.js";import"./lessons-Da3zTMZC.js";import"./subjects-C6d1o6xl.js";import"./programs-N_YEcOwc.js";import"./index-vBEeQODu.js";function te(){const[l]=b(),{t:o}=v(),[a,r]=p.useState(Object.fromEntries(l.entries())),{data:n,refetch:c,isLoading:d,isFetching:m}=D({queryKey:["tasks",a],queryFn:()=>f.get(a),refetchOnWindowFocus:!1}),{modalProps:h,onCreate:j,onEdit:g}=_(()=>c()),y=F({mutationFn:t=>f.destroy(t),onSuccess(){c()}});p.useEffect(()=>{r(Object.fromEntries(l.entries()))},[l]);function k(t){r(t)}function S(){r({})}const w=t=>{y.mutate(t.id)},C=[{title:o("app.fields.date"),dataIndex:"date",render:(t,s)=>e.jsx("div",{children:Y(s.date).format("YYYY-MM-DD")})},{title:o("app.fields.note"),dataIndex:"note",render:(t,s)=>e.jsx("div",{children:s.note})},{title:o("app.lessons.title"),dataIndex:"lessons",render:(t,s)=>{var i;return e.jsx("div",{children:((i=s.lessons)==null?void 0:i.map(T=>T.title).join(", "))??"-"})}},{title:o("app.fields.assignment"),dataIndex:"assignment",render:(t,s)=>{var i;return e.jsx("div",{children:((i=s.assignment)==null?void 0:i.title)??"-"})}},{title:o("common.action"),dataIndex:"operation",width:100,render:(t,s)=>e.jsxs("div",{className:"flex w-full justify-end text-gray",children:[e.jsx(I,{onClick:()=>g(s),children:e.jsx(u,{icon:"solar:pen-bold-duotone",size:18})}),e.jsx(x,{style:{width:10},children:" "}),e.jsx(q,{title:o("common.confirm-deleting"),okText:o("common.ok"),cancelText:o("common.cancel"),placement:"left",onConfirm:()=>w(s),children:e.jsx("button",{type:"button",children:e.jsx(u,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}];return e.jsxs(x,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx(O,{formValue:a,okDisabled:d||m,onClear:S,onSearch:k}),e.jsx(z,{children:o("app.tasks.grid-header")}),e.jsxs(B,{extra:e.jsxs(P,{type:"primary",onClick:()=>j(),children:[" ",o("common.create")," "]}),children:[e.jsx(M,{rowKey:"id",size:"small",scroll:{x:"max-content"},columns:C,locale:{emptyText:e.jsx(E,{description:"No Data",children:"Please select a level"})},dataSource:n==null?void 0:n.items,loading:d||m,pagination:{pageSizeOptions:[10,30,50],current:a.page??1,showSizeChanger:!0,showQuickJumper:!0,total:n==null?void 0:n.total,onChange:(t,s)=>r({...a,page:t,pageSize:s})}}),e.jsx(N,{...h})]})]})}export{te as default};
