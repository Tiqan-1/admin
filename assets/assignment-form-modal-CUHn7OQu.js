import{F as l,r as f,b as c,j as e,w as v,s,x as i,y as R,g as W}from"./index-BdQtXFIb.js";import{d as m}from"./dayjs.min-VOXu_M_J.js";import{a as z}from"./levels-DocYTlfs.js";import{s as D}from"./subjects-CT4RS3MH.js";import{p as B}from"./programs-CXoUo4uA.js";import{S as o}from"./index-1CAj6Hqy.js";import{T as g}from"./index-Cm6Cqhm3.js";import{D as y}from"./index-CD7j3AhG.js";function Y({title:I,show:F,initialValues:r,okDisabled:q,onOk:w,onCancel:S}){var b,j,x;const[n]=l.useForm(),[u,A]=f.useState(void 0);f.useEffect(()=>{n.setFieldsValue({...r})},[r,n]);const P=c({queryKey:["programs"],queryFn:()=>B.get(),refetchOnWindowFocus:!1}),T=c({queryKey:["levels",u],enabled:!!u,queryFn:()=>z.get({programId:u}),refetchOnWindowFocus:!1}),k=c({queryKey:["subjects"],queryFn:()=>D.get({}),refetchOnWindowFocus:!1}),p=(b=P.data)==null?void 0:b.items.map(({id:a,name:t})=>({value:a,label:e.jsx("span",{children:t})}));p==null||p.unshift({value:"",label:e.jsx("span",{children:""})});const O=(j=T.data)==null?void 0:j.items.map(({id:a,name:t})=>({value:a,label:e.jsx("span",{children:t})})),d=(x=k.data)==null?void 0:x.items.map(({id:a,name:t})=>({value:a,label:e.jsx("span",{children:t})}));d==null||d.unshift({value:"",label:e.jsx("span",{children:""})});const C=[{value:v.exam,label:e.jsx("span",{children:s("app.assignments.types.exam")})},{value:v.homework,label:e.jsx("span",{children:s("app.assignments.types.homework")})}],E=[{value:i.draft,label:e.jsx("span",{children:s("app.assignments.states.draft")})},{value:i.published,label:e.jsx("span",{children:s("app.assignments.states.published")})},{value:i.canceled,label:e.jsx("span",{children:s("app.assignments.states.canceled")})},{value:i.closed,label:e.jsx("span",{children:s("app.assignments.states.closed")})},{value:i.deleted,label:e.jsx("span",{children:s("app.assignments.states.deleted")})}],M=a=>{A(a),n.setFieldsValue({levelId:null})},h={getValueProps:a=>({value:a&&m(a)}),normalize:a=>a&&`${m(a).toISOString()}`};return e.jsxs(R,{forceRender:!0,title:I,open:F,okButtonProps:{autoFocus:!0,htmlType:"submit",disabled:q},okText:r.id===void 0?s("common.create"):s("common.edit"),cancelText:s("common.cancel"),onCancel:S,modalRender:a=>e.jsx(l,{form:n,initialValues:r,onFinish:t=>{const U=m(t.availableFrom),K=m(t.availableUntil);if(U.isAfter(K)){n.setFields([{name:"availableFrom",errors:[s("app.assignments.errors.availableFromAfterAvailableUntil")]}]);return}w(r.id,t)},labelCol:{span:6},wrapperCol:{span:18},layout:"horizontal",children:a}),children:[e.jsx(l.Item,{label:s("app.fields.type"),name:"type",rules:[{required:!0}],children:e.jsx(o,{showSearch:!0,options:C})}),e.jsx(l.Item,{label:s("app.fields.title"),name:"title",rules:[{required:!0}],children:e.jsx(W,{})}),e.jsx(l.Item,{label:s("app.fields.program"),name:"programId",children:e.jsx(o,{showSearch:!0,options:p,onChange:M})}),e.jsx(l.Item,{label:s("app.fields.level"),name:"levelId",rules:[{required:!0}],children:e.jsx(o,{showSearch:!0,options:O})}),e.jsx(l.Item,{label:s("app.fields.subject"),name:"subjectId",children:e.jsx(o,{showSearch:!0,options:d})}),r.id&&e.jsx(l.Item,{label:s("app.fields.state"),name:"state",rules:[{required:!0}],children:e.jsx(o,{showSearch:!0,options:E})}),e.jsx(l.Item,{label:s("app.fields.durationInMinutes"),name:"durationInMinutes",rules:[{required:!0}],children:e.jsx(g,{min:1,style:{width:"100%"}})}),e.jsx(l.Item,{label:s("app.fields.passingScore"),name:"passingScore",rules:[{required:!0}],children:e.jsx(g,{min:1,style:{width:"100%"}})}),e.jsx(l.Item,{label:s("app.fields.availableFrom"),name:"availableFrom",...h,rules:[{required:!0}],children:e.jsx(y,{})}),e.jsx(l.Item,{label:s("app.fields.availableUntil"),name:"availableUntil",...h,rules:[{required:!0}],children:e.jsx(y,{})})]})}export{Y as default};
